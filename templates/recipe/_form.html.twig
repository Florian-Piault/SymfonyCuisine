{{ form_start(form) }}
    {{ form_widget(form) }}
    <ul class="ingredientQuantities" data-index="{{ form.ingredientQuantities|length > 0 ? form.ingredientQuantities|last.vars.name + 1 : 0 }}" data-prototype="{{ form_widget(form.ingredientQuantities.vars.prototype)|e('html_attr') }}"></ul></ul>
    <button type="button" class="add_item_link" data-collection-holder-class="ingredientQuantities">Add an ingredient</button>
    {{ form_widget(form.ingredientQuantities.vars.prototype.name)|e }}

    {% block javascript %}
        <script>
            document
                .querySelectorAll('.add_item_link')
                .forEach(btn => btn.addEventListener("click", addFormToCollection));


            const addFormToCollection = (e) => {
                const collectionHolder = document.querySelector('.' + e.currentTarget.dataset.collectionHolderClass);

                const item = document.createElement('li');

                item.innerHTML = collectionHolder
                    .dataset
                    .prototype
                    .replace(
                    /__name__/g,
                    collectionHolder.dataset.index
                );

                collectionHolder.appendChild(item);

                collectionHolder.dataset.index++;
            };
        </script>
    {% endblock %}

    <button class="btn">{{ button_label|default('Save') }}</button>
{{ form_end(form) }}
